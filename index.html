<!DOCTYPE html>
<html>
<head>
    <title>Super Akimmcuy - Solid Wall Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #5c94fc; font-family: 'Arial Black', sans-serif; }
        #hud { position: absolute; top: 20px; left: 20px; color: white; text-shadow: 2px 2px #000; font-size: 20px; z-index: 100; }
        #msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: yellow; font-size: 50px; text-shadow: 5px 5px #000; display: none; z-index: 100; }
    </style>
</head>
<body>
    <div id="hud">MARIO AKIMMCUYY | COINS: <span id="coins">0</span></div>
    <div id="msg">TAMAT! üèÜ</div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let coins = 0;
let cameraX = 0;
let win = false;

const player = {
    x: 100, y: 100, w: 35, h: 50,
    vx: 0, vy: 0, speed: 6, jump: -16,
    grounded: false
};

// --- LEVEL DESIGN: RINTANGAN SUSAH ---
const platforms = [
    {x: 0, y: canvas.height - 60, w: 1000, h: 60, type: 'ground'},
    {x: 400, y: canvas.height - 200, w: 40, h: 40, type: 'block', hit: false},
    {x: 440, y: canvas.height - 200, w: 40, h: 40, type: 'brick'},
    {x: 480, y: canvas.height - 200, w: 40, h: 40, type: 'block', hit: false},
    
    // PIPA PADAT (Tembok)
    {x: 700, y: canvas.height - 160, w: 80, h: 100, type: 'pipe'},
    {x: 950, y: canvas.height - 210, w: 80, h: 150, type: 'pipe'},
    
    // JURANG & LANTAI 2
    {x: 1200, y: canvas.height - 60, w: 600, h: 60, type: 'ground'},
    {x: 1400, y: canvas.height - 200, w: 150, h: 30, type: 'brick'},
    
    // TANGGA MAUT (Sangat Solid)
    {x: 1900, y: canvas.height - 100, w: 50, h: 40, type: 'brick'},
    {x: 1950, y: canvas.height - 140, w: 50, h: 80, type: 'brick'},
    {x: 2000, y: canvas.height - 180, w: 50, h: 120, type: 'brick'},
    {x: 2050, y: canvas.height - 220, w: 50, h: 160, type: 'brick'},
    
    {x: 2250, y: canvas.height - 60, w: 800, h: 60, type: 'ground'},
    {x: 2800, y: canvas.height - 360, w: 10, h: 300, type: 'finish'}
];

const keys = {};

function update() {
    if (win) return;

    // Reset Velocity Horizontal
    player.vx = 0;
    if (keys["ArrowRight"]) player.vx = player.speed;
    if (keys["ArrowLeft"]) player.vx = -player.speed;

    // Gravitasi
    player.vy += 0.8;

    // --- COLLISION LOGIC KERAS ---
    
    // 1. Cek Sumbu X (Nabrak Samping)
    player.x += player.vx;
    platforms.forEach(p => {
        if (player.x < p.x + p.w && player.x + player.w > p.x &&
            player.y < p.y + p.h && player.y + player.h > p.y) {
            
            if (p.type === 'finish') { win = true; document.getElementById('msg').style.display='block'; return; }
            
            if (player.vx > 0) { // Nabrak Kanan
                player.x = p.x - player.w;
            } else if (player.vx < 0) { // Nabrak Kiri
                player.x = p.x + p.w;
            }
        }
    });

    // 2. Cek Sumbu Y (Injek/Sundul)
    player.grounded = false;
    player.y += player.vy;
    platforms.forEach(p => {
        if (player.x < p.x + p.w && player.x + player.w > p.x &&
            player.y < p.y + p.h && player.y + player.h > p.y) {
            
            if (p.type === 'finish') return;

            if (player.vy > 0) { // Jatuh ke Tanah
                player.y = p.y - player.h;
                player.vy = 0;
                player.grounded = true;
            } else if (player.vy < 0) { // Sundul Atas
                player.y = p.y + p.h;
                player.vy = 2; // Biar mantul dikit
                if (p.type === 'block' && !p.hit) {
                    p.hit = true; coins++;
                    document.getElementById('coins').innerText = coins;
                }
            }
        }
    });

    if (keys[" "] && player.grounded) player.vy = player.jump;

    // Camera & Fall
    cameraX = player.x - canvas.width / 3;
    if (player.y > canvas.height) { player.x = 100; player.y = 100; player.vy = 0; }

    draw();
    requestAnimationFrame(update);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    ctx.translate(-cameraX, 0);

    // Gambar Platforms
    platforms.forEach(p => {
        if (p.type === 'ground') ctx.fillStyle = "#70483c";
        else if (p.type === 'pipe') ctx.fillStyle = "#32cd32";
        else if (p.type === 'block') ctx.fillStyle = p.hit ? "#555" : "#ffcc33";
        else if (p.type === 'finish') ctx.fillStyle = "white";
        else ctx.fillStyle = "#a52a2a";
        
        ctx.fillRect(p.x, p.y, p.w, p.h);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.strokeRect(p.x, p.y, p.w, p.h);

        if(p.type === 'finish') {
            ctx.fillStyle = "red"; ctx.fillRect(p.x - 40, p.y, 40, 40);
        }
    });

    // Gambar Mario
    ctx.fillStyle = "red"; ctx.fillRect(player.x, player.y, player.w, 30);
    ctx.fillStyle = "blue"; ctx.fillRect(player.x, player.y + 30, player.w, 20);
    ctx.fillStyle = "#ffcc99"; ctx.fillRect(player.x + 10, player.y + 5, 20, 20);
    ctx.fillStyle = "darkred"; ctx.fillRect(player.x - 5, player.y, player.w + 10, 8);

    ctx.restore();
}

window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);
update();
</script>
</body>
</html>
