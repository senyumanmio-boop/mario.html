<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Slither Akimmcuy Pro</title>
    <style>
        body { margin: 0; overflow: hidden; background: #050505; font-family: 'Arial', sans-serif; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 10px; left: 10px; color: #0f0; font-family: monospace; pointer-events: none; }
        #leaderboard { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.6); color: white; padding: 10px; border-radius: 5px; font-size: 12px; border: 1px solid #444; min-width: 120px; }
        #joystick-area { position: absolute; bottom: 40px; left: 40px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%; border: 2px solid rgba(255,255,255,0.2); }
        #joystick-stick { position: absolute; width: 40px; height: 40px; background: rgba(0, 255, 204, 0.4); border-radius: 50%; top: 30px; left: 30px; }
        #death-screen { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; text-align: center; display: none; background: rgba(0,0,0,0.9); padding: 30px; border: 2px solid #f00; z-index: 1000; }
    </style>
</head>
<body>

<div id="ui">SKOR: <span id="length">10</span></div>
<div id="leaderboard">
    <b style="color: gold;">LEADERBOARD</b><br>
    <div id="ranks"></div>
</div>

<div id="joystick-area"><div id="joystick-stick"></div></div>

<div id="death-screen">
    <h1 style="color: #ff3333;">KAMU LENYAP!</h1>
    <p>Skor Terakhir: <span id="final-score">0</span></p>
    <button onclick="location.reload()" style="padding: 10px 20px; background: #00ffcc; border: none; font-weight: bold; cursor: pointer;">GAS LAGI!</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("length");
const ranksEl = document.getElementById("ranks");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const WORLD_SIZE = 3000;
let isDead = false;

// Player Setup
let player = {
    name: "Akimmcuy (You)",
    pos: [{x: 0, y: 0}],
    angle: 0,
    speed: 4,
    size: 10,
    color: "#00ffcc"
};

let foods = [];
let bots = [];
const botNames = ["Bot_Gokil", "Ular_Sakti", "Sipaling_IO", "Si_Gesit", "Raja_Slither", "Zoro_Snake", "Luffy_Long", "Skibidi_S", "Ular_Muter", "Gak_Kalah", "Indo_Snake", "Rival_77", "Ghost_Eater", "Bocil_Slither", "Pro_Player"];

// Inisialisasi
function init() {
    for(let i=0; i<300; i++) spawnFood();
    for(let i=0; i<15; i++) spawnBot(botNames[i]);
}

function spawnFood() {
    foods.push({
        x: (Math.random() - 0.5) * WORLD_SIZE,
        y: (Math.random() - 0.5) * WORLD_SIZE,
        size: Math.random() * 4 + 2,
        color: `hsl(${Math.random() * 360}, 100%, 60%)`
    });
}

function spawnBot(name) {
    bots.push({
        name: name,
        pos: [{x: (Math.random()-0.5)*WORLD_SIZE, y: (Math.random()-0.5)*WORLD_SIZE}],
        angle: Math.random() * Math.PI * 2,
        speed: 3 + Math.random(),
        size: 15 + Math.random() * 20,
        color: `hsl(${Math.random() * 360}, 80%, 50%)`,
        turnTimer: 0
    });
}

// Joystick logic
let joystick = { active: false, dx: 0, dy: 0 };
const joyArea = document.getElementById("joystick-area");
const joyStick = document.getElementById("joystick-stick");

window.addEventListener("touchstart", (e) => {
    const t = e.touches[0];
    const r = joyArea.getBoundingClientRect();
    if (t.clientX >= r.left && t.clientX <= r.right && t.clientY >= r.top && t.clientY <= r.bottom) {
        joystick.active = true;
    }
});

window.addEventListener("touchmove", (e) => {
    if(!joystick.active) return;
    const t = e.touches[0];
    const r = joyArea.getBoundingClientRect();
    const centerX = r.left + 50;
    const centerY = r.top + 50;
    
    let dx = t.clientX - centerX;
    let dy = t.clientY - centerY;
    let dist = Math.hypot(dx, dy);
    
    if(dist > 40) { dx *= 40/dist; dy *= 40/dist; }
    joyStick.style.transform = `translate(${dx}px, ${dy}px)`;
    player.angle = Math.atan2(dy, dx);
});

window.addEventListener("touchend", () => {
    joystick.active = false;
    joyStick.style.transform = `translate(0,0)`;
});

function update() {
    if(isDead) return;

    // Move Player
    let newHead = {
        x: player.pos[0].x + Math.cos(player.angle) * player.speed,
        y: player.pos[0].y + Math.sin(player.angle) * player.speed
    };
    player.pos.unshift(newHead);
    if(player.pos.length > player.size) player.pos.pop();

    // Check Wall
    if(Math.abs(newHead.x) > WORLD_SIZE/2 || Math.abs(newHead.y) > WORLD_SIZE/2) die();

    // Move Bots
    bots.forEach(bot => {
        bot.turnTimer--;
        if(bot.turnTimer <= 0) {
            bot.angle += (Math.random() - 0.5) * 1.5;
            bot.turnTimer = 30 + Math.random() * 50;
        }
        let bHead = {
            x: bot.pos[0].x + Math.cos(bot.angle) * bot.speed,
            y: bot.pos[0].y + Math.sin(bot.angle) * bot.speed
        };
        // Bot Wrap World
        if(Math.abs(bHead.x) > WORLD_SIZE/2) bHead.x *= -0.9;
        if(Math.abs(bHead.y) > WORLD_SIZE/2) bHead.y *= -0.9;
        
        bot.pos.unshift(bHead);
        if(bot.pos.length > bot.size) bot.pos.pop();

        // Bot Makan
        foods.forEach((f, i) => {
            if(Math.hypot(bHead.x - f.x, bHead.y - f.y) < 20) {
                bot.size += 1;
                foods.splice(i, 1);
                spawnFood();
            }
        });

        // Player nabrak bot
        bot.pos.forEach(p => {
            if(Math.hypot(newHead.x - p.x, newHead.y - p.y) < 12) die();
        });
    });

    // Player Makan
    foods.forEach((f, i) => {
        if(Math.hypot(newHead.x - f.x, newHead.y - f.y) < 20) {
            player.size += 2;
            foods.splice(i, 1);
            spawnFood();
            scoreEl.innerText = Math.floor(player.size);
        }
    });

    updateLeaderboard();
    draw();
    requestAnimationFrame(update);
}

function updateLeaderboard() {
    let all = [player, ...bots].sort((a,b) => b.size - a.size);
    ranksEl.innerHTML = all.slice(0, 5).map((u, i) => 
        `<div>${i+1}. ${u.name.substring(0,10)}: ${Math.floor(u.size)}</div>`
    ).join("");
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    let camX = canvas.width/2 - player.pos[0].x;
    let camY = canvas.height/2 - player.pos[0].y;
    
    ctx.save();
    ctx.translate(camX, camY);

    // Border
    ctx.strokeStyle = "red"; ctx.lineWidth = 10;
    ctx.strokeRect(-WORLD_SIZE/2, -WORLD_SIZE/2, WORLD_SIZE, WORLD_SIZE);

    // Food
    foods.forEach(f => {
        ctx.fillStyle = f.color;
        ctx.beginPath(); ctx.arc(f.x, f.y, f.size, 0, Math.PI*2); ctx.fill();
    });

    // Draw Bots
    bots.forEach(bot => {
        ctx.fillStyle = bot.color;
        bot.pos.forEach(p => {
            ctx.beginPath(); ctx.arc(p.x, p.y, 10, 0, Math.PI*2); ctx.fill();
        });
    });

    // Draw Player
    player.pos.forEach((p, i) => {
        ctx.fillStyle = i === 0 ? "white" : player.color;
        ctx.beginPath(); ctx.arc(p.x, p.y, 12 - (i*0.05), 0, Math.PI*2); ctx.fill();
    });

    ctx.restore();
}

function die() {
    if(isDead) return;
    isDead = true;
    document.getElementById("death-screen").style.display = "block";
    document.getElementById("final-score").innerText = Math.floor(player.size);
}

init();
update();
</script>
</body>
</html>
